<!doctype html>
<html lang="ro" data-theme="dark">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Bucătarul Personal — Model Dark</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Playfair+Display:wght@600;700;800&display=swap" rel="stylesheet">

<!-- Preload imagine HERO cu srcset -->
<link rel="preload" as="image"
  href="https://images.unsplash.com/photo-1559339352-11d035aa65de?auto=format&fit=crop&w=1600&q=70"
  imagesrcset="
    https://images.unsplash.com/photo-1559339352-11d035aa65de?auto=format&fit=crop&w=900&q=70 900w,
    https://images.unsplash.com/photo-1559339352-11d035aa65de?auto=format&fit=crop&w=1400&q=70 1400w,
    https://images.unsplash.com/photo-1559339352-11d035aa65de?auto=format&fit=crop&w=1600&q=70 1600w"
  imagesizes="(max-width:640px) 100vw, (max-width:960px) 100vw, 800px">

<style>
:root{
  --bg:#0f1113; --card:#15181b; --muted:#87939b; --ink:#eff3f5;
  --gold:#d4b258; --line:#23282d; 
  /* Verde rubin brand */
  --green:#0e5a43; 
  --green-2:#0a4a35;
  --danger:#ef6b6b;
  --rad:18px; --shadow:0 18px 50px rgba(0,0,0,.35);
}
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:linear-gradient(180deg,#0f1113,#101316);color:var(--ink);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial}
.container{width:min(1120px,92%);margin:auto}
/* Tema Light */
[data-theme="light"]{
  --bg:#f7faf8; --card:#ffffff; --muted:#5e6a6e; --ink:#18221f;
  --line:#e3ece7; --danger:#c44b4b;
}
/* Fundal și inputuri să folosească variabilele curente */
body{background:linear-gradient(180deg,var(--bg),color-mix(in srgb,var(--bg) 85%, #000 15%));}
input,select,textarea{
  background:color-mix(in srgb,var(--bg) 92%, #000 8%);
  color:var(--ink);
  border:1px solid color-mix(in srgb,var(--line) 85%, var(--green) 15%);
}
.tabbar{
  background:linear-gradient(180deg, color-mix(in srgb,var(--bg) 88%, #000 12%), color-mix(in srgb,var(--bg) 96%, #000 4%));
  border-top:1px solid color-mix(in srgb, var(--line) 85%, #000 15%);
}
/* Header minimalist */
.header{position:sticky;top:0;z-index:50;background:rgba(16,19,22,.75);backdrop-filter:blur(10px);border-bottom:1px solid var(--line)}
.header .wrap{display:flex;align-items:center;justify-content:space-between;padding:12px 0}
.brand{display:flex;align-items:center;gap:10px;min-width:0}
.logo{width:42px;height:42px;border-radius:12px;display:grid;place-items:center;font-weight:800;color:#141617;
  background:conic-gradient(from 210deg,var(--gold),#f3df9b,var(--gold))}
.brand h1{margin:0;font:800 20px/1 Playfair Display,serif;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.brand small{display:block;color:var(--muted);margin-top:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.header .actions{display:flex;gap:8px}
.btn{border:0;border-radius:12px;padding:12px 16px;cursor:pointer;transition:transform .12s ease, border-color .12s ease, background-color .12s ease}
.btn:active{transform:translateY(1px)}
.btn.primary{background:var(--green);color:#e8fff6}
.btn.primary:hover{background:var(--green-2)}
.btn.outline{background:transparent;border:1px solid var(--line);color:var(--ink)}
.btn.outline:hover{border-color:#324048}
.btn.gold{background:var(--gold);color:#141617}
.btn.gold:hover{filter:saturate(1.05)}
/* Header mai lizibil peste imagini */
.header{
  background:linear-gradient(180deg, rgba(16,19,22,.96) 0%, rgba(16,19,22,.78) 100%);
  box-shadow:0 10px 30px rgba(0,0,0,.25);
}

/* Buton „sticlă” pentru contrast maxim */
.btn.glass{
  background:rgba(10,14,12,.55);
  border:1px solid color-mix(in srgb, var(--gold) 45%, transparent);
  color:#fff;
}
.btn.glass:hover{ background:rgba(10,14,12,.75); }

/* Titlul să rămână citibil peste imagini */
.brand h1{ text-shadow:0 2px 10px rgba(0,0,0,.35); }
/* Focus vizibil */
button:focus, input:focus, select:focus, textarea:focus{outline:2px solid color-mix(in srgb, var(--green) 55%, white 0%); outline-offset:2px}

/* Tabs (routes) */
.route{display:none;padding:16px 0 90px}.route.show{display:block}

/* HERO */
.hero{display:grid;grid-template-columns:1.2fr .8fr;gap:18px;align-items:center;margin:18px 0}
.hero .image{border-radius:22px;overflow:hidden;box-shadow:var(--shadow)}
.hero .image > *{width:100%;height:100%}
.hero .image picture,
.hero .image img{object-fit:cover}
.hero h2{font:800 clamp(28px,5vw,56px)/1.1 Playfair Display,serif;margin:0}
.hero p{color:var(--muted);margin:8px 0 14px}
.pills{display:flex;gap:8px;flex-wrap:wrap}
.pill{background:#0c0e10;border:1px solid var(--line);color:#cbd5db;padding:8px 12px;border-radius:999px;font-size:14px}

/* Cards */
.card{background:var(--card);border:1px solid var(--line);border-radius:var(--rad);padding:16px;box-shadow:var(--shadow)}
.card h3{margin:0 0 10px}
label{display:grid;gap:6px;margin:8px 0}
input,select,textarea{background:#0f1316;color:#e7ecef;border:1px solid #243038;border-radius:12px;padding:12px}
input::placeholder{color:#60707a}

/* Imagini responsive globale */
img{max-width:100%;height:auto;display:block}

/* Galerie: carduri 16:9 responsive + scroll fluid */
.scroller{display:grid;grid-auto-flow:column;grid-auto-columns:80%;gap:12px;overflow:auto;scroll-snap-type:x mandatory;margin:10px 0;padding-bottom:2px}
.scroller::-webkit-scrollbar{height:8px}
.scroller::-webkit-scrollbar-thumb{background:#1b2227;border-radius:8px}
.snap{aspect-ratio:16/9; border-radius:18px; overflow:hidden; border:1px solid var(--line); scroll-snap-align:center}
.snap img{width:100%;height:100%;object-fit:cover}

/* GRID */
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
/* Chef grid: poze 4:3 responsive */
.chef .pic{aspect-ratio:4/3; border-radius:14px; overflow:hidden; margin-bottom:8px; border:1px solid var(--line)}
.chef .pic img{width:100%;height:100%;object-fit:cover}
.chef .meta{display:flex;align-items:center;justify-content:space-between}
.stars{color:#f5cc4b}

/* Dashboard */
.stack{display:grid;grid-template-columns:280px 1fr;gap:16px}
.sidebar .tab{width:100%;text-align:left;background:transparent;border:1px solid var(--line);padding:12px;border-radius:14px;color:#d7e0e6;cursor:pointer;margin-bottom:8px;transition:background-color .12s ease,border-color .12s ease}
.sidebar .tab:hover{border-color:#3a444c}
.sidebar .tab.active{background:#0c0f12;border-color:#3a444c}
.badge{display:inline-block;background:#0c1610;border:1px solid #264733;color:#baf5d0;border-radius:999px;padding:6px 12px;font-size:12px}
.list{display:grid;gap:10px}
.item{background:#0f1316;border:1px solid #243038;border-radius:16px;padding:14px}
.status{display:inline-block;background:var(--green);color:#fff;border-radius:999px;padding:6px 12px;font-size:12px}
@media (max-width:640px){
  .header .actions .btn.gold{ padding:10px 12px }
  .brand h1{ font-size:18px }
}
/* TABBAR premium + safe-area */
.tabbar{
  position:fixed; left:0; right:0; bottom:0;
  height:84px; /* mai înalt */
  padding-bottom:calc(env(safe-area-inset-bottom, 0px) + 10px);
  background:linear-gradient(180deg, rgba(13,16,19,.92), rgba(13,16,19,.98));
  backdrop-filter:blur(12px);
  border-top:1px solid color-mix(in srgb, var(--line) 70%, #000 30%);
  display:grid; grid-template-columns:repeat(5,1fr);
  z-index:80; box-shadow:0 -12px 30px rgba(0,0,0,.35);
}
.tabbar button{
  background:transparent; border:0; color:#cfd8dc;
  font-size:13px; display:grid; place-items:center; gap:6px;
  padding:10px 4px; border-radius:14px; margin:6px 8px;
  transition:background .15s ease, color .15s ease, transform .12s ease;
}
.tabbar button .emoji{ font-size:22px; line-height:1; }
.tabbar button.active{
  color:#fff;
  background:linear-gradient(180deg, color-mix(in srgb, var(--green) 28%, transparent), rgba(255,255,255,.04));
  box-shadow:inset 0 0 0 1px color-mix(in srgb, var(--green) 45%, transparent), 0 6px 16px rgba(0,0,0,.25);
}
.tabbar button:active{ transform:translateY(1px) }
[data-theme="light"] .tabbar{
  background:linear-gradient(180deg,#f9fbfa,#eef2f0);
  border-top:1px solid #d0d7d3;
}
[data-theme="light"] .tabbar button{
  color:#485451;
}
[data-theme="light"] .tabbar button.active{
  color:var(--green);
  background:rgba(14,90,67,.08);
  box-shadow:inset 0 0 0 1px rgba(14,90,67,.25);
}
/* Responsive */
@media (max-width:1100px){
  .brand small{display:none}
}
@media (max-width:960px){
  .header .wrap{padding:10px 0}
  .hero{grid-template-columns:1fr;gap:14px}
  .hero .image{aspect-ratio:16/9}
  .stack{grid-template-columns:1fr}
  .grid{grid-template-columns:1fr 1fr}
  .scroller{grid-auto-columns:80%}
}
@media (max-width:640px){
  .btn{padding:12px 14px}
  .hero .image{aspect-ratio:4/3}
  .grid{grid-template-columns:1fr}
  .tabbar{height:72px}
  .scroller{grid-auto-columns:90%}
}
@media (pointer:coarse){
  .btn{padding:14px 18px} /* tap-target mai mare pe mobile */
}
  .testimonials .quote{
  background:var(--card); border:1px solid var(--line);
  border-radius:16px; padding:16px; box-shadow:var(--shadow);
}
.testimonials .stars{ color:#f5cc4b; letter-spacing:1px; font-size:16px }
.testimonials .who{ color:#b6c3c9; font-size:14px }
.testi-grid{ display:grid; gap:12px; grid-template-columns:repeat(3,1fr) }
@media (max-width:960px){ .testi-grid{ grid-template-columns:1fr 1fr } }
@media (max-width:640px){ .testi-grid{ grid-template-columns:1fr } }
/* ======= CORECTIONS LIGHT THEME ======= */
[data-theme="light"] .brand h1,
[data-theme="light"] .brand small{
  color:var(--ink);
  text-shadow:none;
}

[data-theme="light"] .logo{
  background:conic-gradient(from 210deg,var(--gold),#f6e7b2,var(--gold));
  color:#000;
}

[data-theme="light"] .btn.outline{
  border:1px solid color-mix(in srgb, var(--green) 45%, #000 10%);
  color:var(--ink);
  background:rgba(255,255,255,.4);
}
[data-theme="light"] .btn.outline:hover{
  background:rgba(255,255,255,.7);
}

[data-theme="light"] .btn.gold{
  background:var(--gold);
  color:#000;
}
</style>
</head>
<body>
<header class="header">
  <div class="container wrap">
    <div class="brand">
      <div class="logo">BP</div>
      <div>
        <h1>Bucătarul Personal</h1>
        <small>Chef acasă · Evenimente · Meniuri</small>
      </div>
    </div>
   <div class="actions">
  <button class="btn glass" data-route="auth">Autentificare</button>
  <button class="btn gold" data-route="dashboard">Dashboard</button>
</div>
  </div>
</header>

<main class="container">
  <!-- HOME -->
  <section class="route show" id="home">
    <div class="hero">
      <div class="image" aria-hidden="true">
        <picture>
          <source media="(max-width:640px)" srcset="https://images.unsplash.com/photo-1559339352-11d035aa65de?auto=format&fit=crop&w=900&q=70">
          <source media="(max-width:960px)" srcset="https://images.unsplash.com/photo-1559339352-11d035aa65de?auto=format&fit=crop&w=1400&q=70">
          <img 
            src="https://images.unsplash.com/photo-1559339352-11d035aa65de?auto=format&fit=crop&w=1600&q=70" 
            alt=""
            loading="eager"
            fetchpriority="high"
            decoding="async">
        </picture>
      </div>
      <div>
        <h2>Fine dining acasă,<br>de la bucătari verificați</h2>
        <p>Alege un chef, stabilește meniul pe chat și bucură-te de plating impecabil, ingrediente de sezon și curățenie la final.</p>
        <div class="pills">
          <span class="pill">🍝 Meniuri personalizate</span>
          <span class="pill">🥩 Grill & steak</span>
          <span class="pill">🍰 Deserturi artizanale</span>
        </div>

        <div class="card" style="margin-top:14px">
          <h3>Comandă rapidă</h3>
          <form id="quickOrderForm">
            <label>Nume <input name="nume" required placeholder="Nume Prenume"></label>
            <label>Email <input type="email" name="email" required placeholder="email@exemplu.com"></label>
            <label>Oraș <input name="oras" placeholder="Milano / Roma"></label>
            <label>Tip eveniment
              <select name="tip"><option>Cină privată</option><option>Eveniment corporate</option><option>Meniuri zilnice</option></select>
            </label>
            <label>Data <input type="date" name="data"></label>
            <label>URL imagine (opțional) <input type="url" name="img" placeholder="https://..."></label>
            <button class="btn primary" type="submit">Trimite cererea</button>
          </form>
        </div>
      </div>
    </div>

    <div class="card">
      <h3>Inspirație</h3>
      <div class="scroller" role="region" aria-label="Galerie inspirație">
        <div class="snap">
          <img 
            src="https://images.unsplash.com/photo-1544025162-d76694265947?auto=format&fit=crop&w=1400&q=70"
            srcset="
              https://images.unsplash.com/photo-1544025162-d76694265947?auto=format&fit=crop&w=700&q=60 700w,
              https://images.unsplash.com/photo-1544025162-d76694265947?auto=format&fit=crop&w=1200&q=65 1200w,
              https://images.unsplash.com/photo-1544025162-d76694265947?auto=format&fit=crop&w=1600&q=70 1600w"
            sizes="(max-width:640px) 90vw, (max-width:960px) 80vw, 800px"
            alt=""
            loading="lazy"
            decoding="async">
        </div>
        <div class="snap">
          <img 
            src="https://images.unsplash.com/photo-1543352634-8730a9b86571?auto=format&fit=crop&w=1400&q=70"
            srcset="
              https://images.unsplash.com/photo-1543352634-8730a9b86571?auto=format&fit=crop&w=700&q=60 700w,
              https://images.unsplash.com/photo-1543352634-8730a9b86571?auto=format&fit=crop&w=1200&q=65 1200w,
              https://images.unsplash.com/photo-1543352634-8730a9b86571?auto=format&fit=crop&w=1600&q=70 1600w"
            sizes="(max-width:640px) 90vw, (max-width:960px) 80vw, 800px"
            alt=""
            loading="lazy"
            decoding="async">
        </div>
        <div class="snap">
          <img 
            src="https://images.unsplash.com/photo-1476127396924-2aa7d3b74d04?auto=format&fit=crop&w=1400&q=70"
            srcset="
              https://images.unsplash.com/photo-1476127396924-2aa7d3b74d04?auto=format&fit=crop&w=700&q=60 700w,
              https://images.unsplash.com/photo-1476127396924-2aa7d3b74d04?auto=format&fit=crop&w=1200&q=65 1200w,
              https://images.unsplash.com/photo-1476127396924-2aa7d3b74d04?auto=format&fit=crop&w=1600&q=70 1600w"
            sizes="(max-width:640px) 90vw, (max-width:960px) 80vw, 800px"
            alt=""
            loading="lazy"
            decoding="async">
        </div>
        <div class="snap">
          <img 
            src="https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?auto=format&fit=crop&w=1400&q=70"
            srcset="
              https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?auto=format&fit=crop&w=700&q=60 700w,
              https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?auto=format&fit=crop&w=1200&q=65 1200w,
              https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?auto=format&fit=crop&w=1600&q=70 1600w"
            sizes="(max-width:640px) 90vw, (max-width:960px) 80vw, 800px"
            alt=""
            loading="lazy"
            decoding="async">
        </div>
      </div>
    </div>
<section class="card testimonials" aria-labelledby="testiTitle">
  <h3 id="testiTitle">Ce spun clienții noștri</h3>
  <div class="testi-grid">
    <div class="quote">
      <div class="stars">★★★★★</div>
      <p>„Experiență impecabilă! Chef-ul a respectat toate preferințele și a lăsat bucătăria lună.”</p>
      <div class="who">— Ana M., Milano · cină privată</div>
    </div>
    <div class="quote">
      <div class="stars">★★★★★</div>
      <p>„Plating de restaurant și meniuri adaptate invitaților noștri. Recomand pentru evenimente corporate.”</p>
      <div class="who">— Luca R., Roma · eveniment corporate</div>
    </div>
    <div class="quote">
      <div class="stars">★★★★☆</div>
      <p>„Deserturile au fost highlight-ul serii. Comunicarea pe chat a făcut totul foarte simplu.”</p>
      <div class="who">— Ioana D., Firenze · cină romantică</div>
    </div>
  </div>
</section>
    <div class="card">
      <h3>Chefii noștri</h3>
      <div class="grid">
        <div class="chef">
          <div class="pic">
            <img src="https://images.unsplash.com/photo-1549029335-5a6cbf0f6d49?auto=format&fit=crop&w=1200&q=60" alt="" loading="lazy" decoding="async">
          </div>
          <div class="meta"><strong>Andrei · Milano</strong><span class="stars">★★★★★</span></div>
        </div>
        <div class="chef">
          <div class="pic">
            <img src="https://images.unsplash.com/photo-1542843137-8791a6904d14?auto=format&fit=crop&w=1200&q=60" alt="" loading="lazy" decoding="async">
          </div>
          <div class="meta"><strong>Bianca · Roma</strong><span class="stars">★★★★★</span></div>
        </div>
        <div class="chef">
          <div class="pic">
            <img src="https://images.unsplash.com/photo-1524041255072-7da0525d6b34?auto=format&fit=crop&w=1200&q=60" alt="" loading="lazy" decoding="async">
          </div>
          <div class="meta"><strong>Marco · Firenze</strong><span class="stars">★★★★☆</span></div>
        </div>
      </div>
    </div>
  </section>

  <!-- AUTH -->
  <section class="route" id="auth">
    <div class="card" style="max-width:680px;margin:14px auto">
      <h3>Autentificare / Înregistrare</h3>
      <div style="display:flex;gap:8px;margin-bottom:10px">
        <button class="btn outline" id="tabLoginBtn">Login</button>
        <button class="btn outline" id="tabSignupBtn">Creează cont</button>
      </div>
      <div id="tabLogin">
        <form id="loginForm">
          <label>Email <input type="email" name="email" required></label>
          <label>Parolă <input type="password" name="password" required></label>
          <button class="btn primary" type="submit">Autentificare</button>
        </form>
      </div>
      <div id="tabSignup" style="display:none">
        <form id="signupForm">
          <label>Nume <input name="name" required></label>
          <label>Email <input type="email" name="email" required></label>
          <label>Parolă <input type="password" name="password" required></label>
          <label>Rol
            <select name="role"><option value="client">Client</option><option value="chef">Bucătar</option></select>
          </label>
          <button class="btn gold" type="submit">Creează cont</button>
        </form>
      </div>
      <p style="color:var(--muted);font-size:13px;margin-top:8px">Demo: stochează datele local (LocalStorage).</p>
    </div>
  </section>

  <!-- DASHBOARD -->
  <section class="route" id="dashboard">
    <div class="stack">
      <aside class="card sidebar">
        <button class="tab active" data-panel="orders">Comenzi</button>
        <button class="tab" data-panel="menus">Meniurile mele</button>
        <button class="tab" data-panel="chat">Chat</button>
        <button class="tab" data-panel="calendar">Calendar</button>
        <button class="tab" data-panel="settings">Setări</button>
        <div style="margin-top:10px" id="roleBadge" class="badge">Rol: -</div>
      </aside>

      <section class="card">
        <!-- ORDERS -->
        <div class="panel show" id="panel-orders">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;gap:8px;flex-wrap:wrap">
            <h3 style="margin:0">Comenzi</h3>
            <button id="newOrderBtn" class="btn gold">+ Cerere nouă</button>
          </div>
          <div id="ordersList" class="list"></div>
        </div>

        <!-- MENUS -->
        <div class="panel" id="panel-menus">
          <h3>Meniurile mele</h3>
          <form id="menuForm" style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px">
            <input id="menuTitle" placeholder="Titlu" required>
            <input id="menuPrice" type="number" placeholder="Preț RON" required>
            <input id="menuImageUrl" type="url" placeholder="URL imagine (opțional)">
            <button class="btn primary" type="submit">Salvează</button>
          </form>
          <div id="menusList" class="grid"></div>
        </div>

        <!-- CHAT -->
        <div class="panel" id="panel-chat">
          <h3>Chat</h3>
          <div id="chatMessages" class="card" style="height:260px;overflow:auto"></div>
          <form id="chatForm" style="display:flex;gap:8px;margin-top:10px">
            <input id="chatInput" placeholder="Mesaj...">
            <button class="btn primary">Trimite</button>
          </form>
        </div>

        <!-- CALENDAR -->
        <div class="panel" id="panel-calendar">
          <h3>Calendar</h3>
          <form id="eventForm" style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px">
            <input type="date" id="eventDate" required>
            <input type="time" id="eventTime" required>
            <input id="eventTitle" placeholder="Titlu" required>
            <button class="btn primary">Adaugă</button>
          </form>
          <ul id="eventsList" class="list"></ul>
        </div>

        <!-- SETTINGS -->
        <div class="panel" id="panel-settings">
          <h3>Setări profil</h3>
          <form id="profileForm" class="grid" style="grid-template-columns:repeat(2,1fr);gap:10px">
            <label>Nume <input id="profileName" required></label>
            <label>Oraș <input id="profileCity"></label>
            <label>Telefon <input id="profilePhone"></label>
            <label>Rol
              <select id="profileRole"><option value="client">Client</option><option value="chef">Bucătar</option></select>
            </label>
            <div style="grid-column:1/-1"><button class="btn gold">Actualizează</button></div>
          </form>
        </div>
      </section>
    </div>
  </section>

  <!-- PROFILE -->
  <section class="route" id="profile">
    <div class="card">
      <h3>Profil</h3>
      <div id="profileCard"></div>
    </div>
  </section>
</main>

<!-- Bottom Tabbar -->
<nav class="tabbar" role="tablist" aria-label="Navigare principală">
  <button class="tablink active" data-go="home"><div class="emoji">🏠</div>Acasă</button>
  <button class="tablink" data-go="dashboard" data-panel="orders"><div class="emoji">🧾</div>Comenzi</button>
  <button class="tablink" data-go="dashboard" data-panel="menus"><div class="emoji">🍽️</div>Meniuri</button>
  <button class="tablink" data-go="dashboard" data-panel="chat"><div class="emoji">💬</div>Chat</button>
  <button class="tablink" data-go="profile"><div class="emoji">👤</div>Profil</button>
</nav>

<script>
const $=(s,c=document)=>c.querySelector(s), $$=(s,c=document)=>[...c.querySelectorAll(s)];
const routes={home:'#home',auth:'#auth',dashboard:'#dashboard',profile:'#profile'};
const panels={orders:'#panel-orders',menus:'#panel-menus',chat:'#panel-chat',calendar:'#panel-calendar',settings:'#panel-settings'};
const state={
  user: JSON.parse(localStorage.getItem('bp_user')||'null'),
  orders: JSON.parse(localStorage.getItem('bp_orders')||'[]'),
  messages: JSON.parse(localStorage.getItem('bp_chat')||'[]'),
  events: JSON.parse(localStorage.getItem('bp_events')||'[]'),
  menus: JSON.parse(localStorage.getItem('bp_menus')||'[]')
};

/* Routing */
function showRoute(name){
  Object.values(routes).forEach(id=>$(id).classList.remove('show'));
  $(routes[name]).classList.add('show');
  if(name==='dashboard') renderDashboard();
  if(name==='profile') renderProfile();
  $$('.tablink').forEach(b=>b.classList.toggle('active', b.dataset.go===name));
}
$$('[data-route]').forEach(b=>b.onclick=(e)=>{e.preventDefault(); showRoute(b.dataset.route);});
$$('.tablink').forEach(b=>b.onclick=()=>{
  showRoute(b.dataset.go);
  if(b.dataset.panel){ setPanel(b.dataset.panel); }
});
function setPanel(name){
  Object.values(panels).forEach(id=>$(id).classList.remove('show'));
  $(panels[name]).classList.add('show');
  $$('.sidebar .tab').forEach(t=>t.classList.toggle('active', t.dataset.panel===name));
}
$$('.sidebar .tab').forEach(t=>t.onclick=()=>setPanel(t.dataset.panel));

/* Auth small UI */
function updateAuthUI(){
  $('#roleBadge') && ( $('#roleBadge').textContent = 'Rol: ' + (state.user?.role || '-') );
}
$('#tabLoginBtn').onclick=()=>{ $('#tabLogin').style.display='block'; $('#tabSignup').style.display='none'; };
$('#tabSignupBtn').onclick=()=>{ $('#tabLogin').style.display='none'; $('#tabSignup').style.display='block'; };

$('#loginForm')?.addEventListener('submit', e=>{
  e.preventDefault();
  const {email,password}=Object.fromEntries(new FormData(e.target).entries());
  const users=JSON.parse(localStorage.getItem('bp_users')||'[]');
  const u=users.find(x=>x.email===email&&x.password===password);
  if(!u) return alert('Date invalide');
  state.user=u; localStorage.setItem('bp_user',JSON.stringify(u));
  updateAuthUI(); showRoute('dashboard');
});
$('#signupForm')?.addEventListener('submit', e=>{
  e.preventDefault();
  const d=Object.fromEntries(new FormData(e.target).entries());
  const users=JSON.parse(localStorage.getItem('bp_users')||'[]');
  if(users.some(u=>u.email===d.email)) return alert('Email existent');
  const nu={id:'u_'+Date.now(), name:d.name, email:d.email, password:d.password, role:d.role, city:'', phone:''};
  users.push(nu); localStorage.setItem('bp_users',JSON.stringify(users));
  state.user=nu; localStorage.setItem('bp_user',JSON.stringify(nu));
  updateAuthUI(); showRoute('dashboard');
});

/* Quick order (home) */
$('#quickOrderForm')?.addEventListener('submit', e=>{
  e.preventDefault();
  const o=Object.fromEntries(new FormData(e.target).entries());
  o.id='ord_'+Date.now(); o.status='nou';
  state.orders.unshift(o); localStorage.setItem('bp_orders',JSON.stringify(state.orders));
  alert('Cerere trimisă!'); e.target.reset();
});

/* Dashboard render */
function renderDashboard(){
  updateAuthUI();

  // orders
  const list=$('#ordersList'); list.innerHTML='';
  const visible=(state.user?.role==='chef')?state.orders:state.orders.filter(o=>o.email===state.user?.email||!state.user);
  if(visible.length===0){ list.innerHTML='<p style="color:#8fa0a8">Nu există comenzi.</p>'; }
  visible.forEach(o=>{
    const el=document.createElement('div'); el.className='item';
    el.innerHTML=`
      ${o.img?`<div style="aspect-ratio:16/9;border-radius:12px;overflow:hidden;margin:-2px -2px 8px;border:1px solid #243038"><img src="${o.img}" style="width:100%;height:100%;object-fit:cover" alt=""></div>`:''}
      <div><strong>${o.tip||'Comandă'}</strong> · <span style="color:#96a3aa">${o.oras||'-'} · ${o.data||''}</span></div>
      <div style="color:#c9d2d8">${o.nume||'-'} — ${o.email||''}</div>
      <span class="status">${o.status}</span>`;
    list.appendChild(el);
  });

  // menus
  const ml=$('#menusList'); if(ml){ ml.innerHTML='';
    state.menus.forEach(m=>{
      const c=document.createElement('div'); c.className='card';
      c.innerHTML=`
        ${m.imageUrl?`<div style="aspect-ratio:4/3;border-radius:14px;overflow:hidden;margin:-4px -4px 10px;border:1px solid var(--line)">
          <img src="${m.imageUrl}" style="width:100%;height:100%;object-fit:cover" alt=""></div>`:''}
        <strong>${m.title}</strong><div style="color:#9fb0b9">Preț: ${m.price} RON</div>`;
      ml.appendChild(c);
    });
  }

  // chat
  renderChat();

  // events
  const ev=$('#eventsList'); if(ev){ ev.innerHTML='';
    state.events.forEach(e=>{
      const li=document.createElement('li'); li.className='item';
      li.innerHTML=`<strong>${e.title}</strong> — ${e.date} ${e.time}`;
      ev.appendChild(li);
    });
  }
}

$('#newOrderBtn')?.addEventListener('click', ()=>{
  const o={id:'ord_'+Date.now(),tip:'Cerere personalizată',nume:state.user?.name||'Client',email:state.user?.email||'',oras:state.user?.city||'',data:'',status:'nou'};
  state.orders.unshift(o); localStorage.setItem('bp_orders',JSON.stringify(state.orders)); renderDashboard();
});

/* Menus add */
$('#menuForm')?.addEventListener('submit', e=>{
  e.preventDefault();
  const title=$('#menuTitle').value, price=Number($('#menuPrice').value||0), imageUrl=($('#menuImageUrl')?.value||'').trim();
  state.menus.push({id:'menu_'+Date.now(), title, price, imageUrl});
  localStorage.setItem('bp_menus',JSON.stringify(state.menus));
  e.target.reset(); renderDashboard();
});

/* Chat */
$('#chatForm')?.addEventListener('submit', e=>{
  e.preventDefault(); const t=$('#chatInput').value.trim(); if(!t) return;
  state.messages.push({id:'m_'+Date.now(), from: state.user?.email||'anon', text:t, at:new Date().toISOString()});
  localStorage.setItem('bp_chat',JSON.stringify(state.messages)); $('#chatInput').value=''; renderChat();
});
function renderChat(){
  const box=$('#chatMessages'); if(!box) return; box.innerHTML='';
  state.messages.slice(-60).forEach(m=>{
    const d=document.createElement('div'); d.className='item';
    d.innerHTML=`<strong>${m.from}</strong> <span style="color:#8ea1aa">${new Date(m.at).toLocaleString()}</span><br>${m.text}`;
    box.appendChild(d);
  });
  box.scrollTop=box.scrollHeight;
}

/* Events */
$('#eventForm')?.addEventListener('submit', e=>{
  e.preventDefault();
  const date=$('#eventDate').value, time=$('#eventTime').value, title=$('#eventTitle').value;
  state.events.push({id:'e_'+Date.now(),date,time,title}); localStorage.setItem('bp_events',JSON.stringify(state.events));
  e.target.reset(); renderDashboard();
});

/* Profile */
function renderProfile(){
  const wrap=$('#profileCard'); if(!wrap) return; wrap.innerHTML='';
  if(!state.user){ wrap.innerHTML='<p style="color:#a8b6be">Neautentificat.</p>'; return; }
  wrap.innerHTML=`<div class="item"><strong>${state.user.name}</strong><br>${state.user.email}<br><span style="color:#9fb0b9">${state.user.city||''} ${state.user.phone?('· '+state.user.phone):''}</span><br><span class="badge">Rol: ${state.user.role}</span></div>`;
}
$('#profileForm')?.addEventListener('submit', e=>{
  e.preventDefault(); if(!state.user) return;
  state.user.name=$('#profileName').value; state.user.city=$('#profileCity').value;
  state.user.phone=$('#profilePhone').value; state.user.role=$('#profileRole').value;
  localStorage.setItem('bp_user',JSON.stringify(state.user)); updateAuthUI(); renderProfile(); alert('Profil actualizat');
});

/* Sidebar panel click sets tabbar focus */
$$('.sidebar .tab').forEach(b=>b.addEventListener('click',()=>$$('.tablink').forEach(t=>t.classList.toggle('active', t.dataset.go==='dashboard'))));
// ---- THEME: init + toggle ----
const prefersDark = matchMedia('(prefers-color-scheme: dark)').matches;
const savedTheme = localStorage.getItem('bp_theme');
document.documentElement.setAttribute('data-theme', savedTheme ?? (prefersDark ? 'dark' : 'light'));
const themeBtn = document.getElementById('themeBtn');
function refreshThemeBtn(){
  const cur = document.documentElement.getAttribute('data-theme');
  themeBtn.textContent = (cur==='dark') ? '🌙 Dark' : '☀️ Light';
}
themeBtn?.addEventListener('click', ()=>{
  const cur = document.documentElement.getAttribute('data-theme');
  const next = (cur==='dark')?'light':'dark';
  document.documentElement.setAttribute('data-theme', next);
  localStorage.setItem('bp_theme', next);
  refreshThemeBtn();
});
refreshThemeBtn();

/* Init */
updateAuthUI();
showRoute('home');
</script>
</body>
</html>
